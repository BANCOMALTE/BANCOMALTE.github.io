<html>
    <head>
        <title>AllScan</title>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=PT+Sans&display=swap');
            body {font-family: 'PT Sans', sans-serif !important; max-width: 1100px !important; align-content: center;   margin: auto !important; padding: 15px !important;}
            @media (min-width: 770px) {
                .logotext {margin-right: 30px !important; font-size: 20px; margin-top: -2px !important;}
                li.nav-item{margin-top: -2px;}
            }
            @media (max-width: 770px) {
                .form-control {max-width: 130px !important; }
                .logotext {text-align: center; font-size: 20px; padding-left: 5px;}
                .navbar-brand {padding-left: 9px !important;}
            }
            .navbar-brand {margin-top: -1px}
            .pure-material-button-contained {
    position: relative;
    display: inline-block;
    box-sizing: border-box;
    border: none;
    border-radius: 4px;
    padding: 0 16px;
    min-width: 64px;
    height: 36px;
    vertical-align: middle;
    text-align: center;
    text-overflow: ellipsis;
    text-transform: uppercase;
    color: rgb(var(--pure-material-onprimary-rgb, 255, 255, 255));
    background-color: rgb(var(--pure-material-primary-rgb, 33, 150, 243));
    box-shadow: 0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12);
    font-family: font-family: 'PT Sans', sans-serif !important;
    font-size: 14px;
    font-weight: 500;
    line-height: 36px;
    overflow: hidden;
    outline: none;
    cursor: pointer;
    transition: box-shadow 0.2s;
}

.pure-material-button-contained::-moz-focus-inner {
    border: none;
}

/* Overlay */
.pure-material-button-contained::before {
    content: "";
    position: absolute;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: rgb(var(--pure-material-onprimary-rgb, 255, 255, 255));
    opacity: 0;
    transition: opacity 0.2s;
}

/* Ripple */
.pure-material-button-contained::after {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;
    border-radius: 50%;
    padding: 50%;
    width: 32px; /* Safari */
    height: 32px; /* Safari */
    background-color: rgb(var(--pure-material-onprimary-rgb, 255, 255, 255));
    opacity: 0;
    transform: translate(-50%, -50%) scale(1);
    transition: opacity 1s, transform 0.5s;
}

/* Hover, Focus */
.pure-material-button-contained:hover,
.pure-material-button-contained:focus {
    box-shadow: 0 2px 4px -1px rgba(0, 0, 0, 0.2), 0 4px 5px 0 rgba(0, 0, 0, 0.14), 0 1px 10px 0 rgba(0, 0, 0, 0.12);
}

.pure-material-button-contained:hover::before {
    opacity: 0.08;
}

.pure-material-button-contained:focus::before {
    opacity: 0.24;
}

.pure-material-button-contained:hover:focus::before {
    opacity: 0.3;
}

/* Active */
.pure-material-button-contained:active {
    box-shadow: 0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12);
}

.pure-material-button-contained:active::after {
    opacity: 0.32;
    transform: translate(-50%, -50%) scale(0);
    transition: transform 0s;
}

/* Disabled */
.pure-material-button-contained:disabled {
    color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.38);
    background-color: rgba(var(--pure-material-onsurface-rgb, 0, 0, 0), 0.12);
    box-shadow: none;
    cursor: initial;
}

.pure-material-button-contained:disabled::before {
    opacity: 0;
}

.pure-material-button-contained:disabled::after {
    opacity: 0;
}
</style>
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <nav class="navbar navbar-expand-lg navbar-light bg-light" style="  border-radius: 10px;">
            <img class="navbar-brand" src="logo.png" height="50px"><a class="navbar-brand, logotext">AllScan</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
              <ul class="navbar-nav">
                <li class="nav-item active">
                  <a class="nav-link" href="https://www.youtube.com/channel/UCO66DuFYNFMdR8Y31Ire1fg">Home <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://bancomalte.github.io/ALLSCANMULTIPLECELLS">AllScan Multiple Cells</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="https://allscango.github.io/ALLSCANGO/">AllScan GO</a>
                </li>
		 <li class="nav-item">
                   <a class="nav-link" href="https://t.me/allscancelle">Canale Telegram</a>
                 </li>
               </ul>
            </div>
          </nav>
        <link rel="icon" href="favicon.ico" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <script src="https://tiles.unwiredmaps.com/js/leaflet-unwired.js"></script>
    <script src="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet/0.0.1-beta.5/esri-leaflet.js"></script>
    <script src="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet-geocoder/0.0.1-beta.5/esri-leaflet-geocoder.js"></script>
     <link rel="stylesheet" type="text/css" href="https://cdn-geoweb.s3.amazonaws.com/esri-leaflet-geocoder/0.0.1-beta.5/esri-leaflet-geocoder.css">   
     <!-- location control -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
<!-- location control -->
<script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
<!-- geocoding plugin -->
<link rel="stylesheet" href="https://maps.locationiq.com/v2/libs/leaflet-geocoder/1.9.5/leaflet-geocoder-locationiq.min.css">
<script src="https://maps.locationiq.com/v2/libs/leaflet-geocoder/1.9.5/leaflet-geocoder-locationiq.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-plugins/3.0.2/control/Permalink.js"></script>
	     <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw-src.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw-src.css">
   <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-174580127-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-174580127-1');
</script>
	    <style>
        #map { height: 100%; width: 100%; border-radius: 15px;}
    
.card { min-width: 200px }
             .form-control, button {max-width: 160px;
            margin:10px;}
		.form-row { justify-content: center; }
</style>
        
        
    <script>
var defaultmarkericon = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
	    var srb = L.icon({
    iconUrl: 'searchbell.png',
   iconSize:     [42, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [10, -39] // point from which the popup should open relative to the iconAnchor
});
    /* 

            Tramite queste variabili è possibile personalizzare i parametri della query che verrà effettuata

            token (string): token Unwired Labs
            radio (string): tecnologia radio
            mcc (int): codice paese
            mnc (int): codice operatore
            lac (int): location area code (default: 1)
            cid (int): cell id da richiedere al servizio
            psc (int): primary scrambling code (default: 0)
            address (boolean): impostare a 1 per richiedere anche l'indirizzo, altrimenti 0

    */

    function AllScan() {
        var  NumToken = 0,
            arrayToken = $("#token").val().replace(/\s+/g, '').split(','),
            radio = $("#radio").val(),
            mcc = $("#mcc").val(),
            mnc = $("#mnc").val(),
            lac = $("#lac").val(),
            startcid = $("#startcid").val(),
            stopcid = $("#stopcid").val(),
            enodeb = $("#enodeb").val(),
            carrier = $("#carrier").val(),
	     secid = $("#secid").val(),
            psc = $("#psc").val(),
	    band = $("#band").val(),
	     cidumts = $("#cidumts").val(),
             rnc = $("#rnc").val(),
	     colorebande = $("#colorebande").val(),
        iconemarker = $("#iconemarker").val(),
	          triangolazione = $("#triangolazione").val(),
	    coordinatedestra = $("#coordinatedestra").val(),
        coordinatesinistra = $("#coordinatesinistra").val(),
        verificafake = $("#verificafake").val(),
            address = 1;
	    
	const [latdestraalto, londestraalto] = coordinatedestra.split(',');
        const [latsinistrabasso, lonsinistrabasso] = coordinatesinistra.split(','); 
       
	    if(stopcid >= startcid){
		switch (radio){
            case '"lte"':
           
		if(enodeb != "" && enodeb > 0){
           if(carrier == "w3"){
                startcid = enodeb * 256;
                stopcid = enodeb * 256 + 29;
              
                }else if (carrier == "vf") {
                startcid = enodeb * 256 + 11;
                stopcid = enodeb * 256 + 94;
                 } else if(carrier == "timHUAWEI") { startcid = enodeb * 256;
                    stopcid = enodeb * 256 + 58;
                
                 } else if(carrier == "timHUAWEIB1"){
                     startcid = enodeb * 256 + 250;
                stopcid = enodeb * 256 + 253;
                     
                 } else if(carrier == "h3g") {    
             startcid = enodeb * 256 + 1;
                stopcid = enodeb * 256 + 6;
                      } else if(carrier == "iliad") {
                startcid = enodeb * 256 + 21;
                stopcid = enodeb * 256 + 83;  
                } else if(carrier == "timers") {
			startcid = enodeb * 256 + 1;
                stopcid = enodeb * 256 + 21; 
		} else if(carrier == "libero") {
                    startcid = stopcid = enodeb * 256 + Number(secid);
               
                } else if(carrier == "sctim") {
			startcid = enodeb * 256 + 1;
                stopcid = enodeb * 256 + 255;
		} else {


                startcid = enodeb * 256 + 21;
                stopcid = enodeb * 256 + 64;
                 }}
		    break;
		    case '"umts"': 
                              if (rnc != "" && cidumts != ""  ) {startcid = stopcid = rnc * 65536 + Number(cidumts); }

                 break;
                 
                 }

            $("#result").html("");
		 var i = 0;
            var arraylon = [];
            var arraylat = [];
		var arrayband = [];
            var uniquearrayband= [];
		var arraysec = [];
		var arraycid = [];
		var arrayenb = [];
            for(var cid = startcid; cid <= stopcid; cid++) {
                var request = {
                    "async": false,
                    "crossDomain": true,
                    "url": "https://eu1.unwiredlabs.com/v2/process.php",
                    "method": "POST",
                    "headers": {},
                    "processData": false,
                    "data": "{\"token\":\"" + arrayToken[NumToken] + "\", \"radio\": " + radio + ", \"mcc\": " + mcc + ", \"mnc\": " + mnc + ", \"cells\": [{ \"lac\": " + lac + ", \"cid\": " + cid + ", \"psc\": " + psc + " }], \"address\": " + address + "}"
                }

                $.ajax(request).done(function (APIresponse) {
                    //se query ok
                    enodeb_c = parseInt(cid/256);
                    sec = cid - (enodeb_c * 256);

			if(radio == '"lte"'){
			 switch (carrier) {
					 case 'w3':
                 if (sec == 0 || sec == 1 || sec == 2 || sec == 3 || sec == 4 || sec == 5 ) {
                         band = "B3";
			  colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 6 || sec == 7 || sec == 8 || sec == 9 || sec == 10 || sec == 11) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 12 || sec == 13 || sec == 14 || sec == 15 || sec == 16 || sec == 17) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (sec == 18 || sec == 19 || sec == 20 || sec == 21 || sec == 22 || sec == 23) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else if (sec == 24 || sec == 25 || sec == 26 || sec == 27 || sec == 28 || sec == 29) {
		     
	                band = "B38";  colorebande = "darkblue"; iconemarker = L.icon({
    iconUrl: 'b38.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});	     
		     
		     
		     
		     
		     } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
      case 'vf':
      if (sec == 31 || sec == 32 || sec == 33 || sec == 34) {
                         band = "B3";
	       colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 11 || sec == 12 || sec == 13 || sec == 14) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 51 || sec == 52 || sec == 53 || sec == 54) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (sec == 41 || sec == 42 || sec == 43 || sec == 44) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else if  (sec == 91 || sec == 92 || sec == 93 || sec == 94) {
                     band = "B8";  colorebande = "brown"; iconemarker = L.icon({
    iconUrl: 'B8.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
                 case 'timHUAWEI':
                 if (sec == 0 || sec == 1 || sec == 2 || sec == 3 || sec == 31 || sec == 32 || sec == 33 || sec == 34 || sec == 35) {
                         band = "B3";
			  colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 6 || sec == 7 || sec == 8 || sec == 9) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 12 || sec == 13 || sec == 14 || sec == 15) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (sec == 36 || sec == 37 || sec == 38 || sec == 39) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else if  (sec == 55 || sec == 56 || sec == 57 || sec == 58) {
                     band = "B8";  colorebande = "brown"; iconemarker = L.icon({
    iconUrl: 'B8.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
                 case 'timHUAWEIB1':
                 if (sec == 250 || sec == 251 || sec == 252 || sec == 253) {
                         band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 
                 break;
                 case 'h3g':
                 if (sec == 1 || sec == 2 || sec == 3 ) {
                         band = "B3";
			  colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 4 || sec == 5 || sec == 6 ) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
                 case 'iliad':
                 if (sec == 61 || sec == 62 || sec == 63 || sec == 41 || sec == 42 || sec == 43) {
                         band = "B7";
			  colorebande = "magenta";
                         iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                
                 } else if (sec == 81 || sec == 82 || sec == 83 ) {
                     band = "B3";
			 colorebande = "green";
                     iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (sec == 21 || sec == 22 || sec == 23 ) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});} else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
                 case 'tim':
                 if (sec == 41 || sec == 42 || sec == 43 || sec == 44) {
                         band = "B3";
			  colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 61 || sec == 62 || sec == 63 || sec == 64) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (sec == 21 || sec == 22 || sec == 23 || sec == 23) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (sec == 31 || sec == 32 || sec == 33 || sec == 34) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});} else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                 break;
		case 'libero':
                 if (mnc == 88 && (sec == 0 || sec == 1 || sec == 2 || sec == 3 || sec == 4 || sec == 5)) {
                         band = "B3";
			  colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 88 &&  (sec == 6 || sec == 7 || sec == 8 || sec == 9 || sec == 10 || sec == 11)) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 88 && (sec == 12 || sec == 13 || sec == 14 || sec == 15 || sec == 16 || sec == 17)) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 88  && (sec == 24 || sec == 25 || sec == 26 || sec == 27 || sec == 28 || sec == 29)) {
			    
			           band = "B38";  colorebande = "darkblue"; iconemarker = L.icon({
    iconUrl: 'b38.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});	     
		     
			    
			    } else if  (mnc == 88  && (sec == 18 || sec == 19 || sec == 20 || sec == 21 || sec == 22 || sec == 23)) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                     else if (mnc == 10 && (sec == 31 || sec == 32 || sec == 33 || sec == 34)) {
                         band = "B3";
			      colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 10  && (sec == 11 || sec == 12 || sec == 13 || sec == 14)) {
                     band = "B20";
			  colorebande = "blue";
                     iconemarker = L.icon({
    iconUrl: 'b20.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 10 && (sec == 51 || sec == 52 || sec == 53 || sec == 54)) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (mnc == 10  && (sec == 41 || sec == 42 || sec == 43 || sec == 44)) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); }
                    else if (mnc == 99 && (sec == 1 || sec == 2 || sec == 3 )) {
                         band = "B3";
			     colorebande = "green";
                         iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 99  && (sec == 4 || sec == 5 || sec == 6 )) {
                     band = "B7";
			 colorebande = "magenta";
                     iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if (mnc == 50 && (sec == 61 || sec == 62 || sec == 63 || sec == 41 || sec == 42 || sec == 43)) {
                         band = "B7";
			  colorebande = "magenta";
                         iconemarker = L.icon({
    iconUrl: 'b7.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                
                 } else if (mnc == 50 && (sec == 81 || sec == 82 || sec == 83 )) {
                     band = "B3";
			 colorebande = "green";
                     iconemarker = L.icon({
    iconUrl: 'b3.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});
                 } else if  (mnc == 50 && (sec == 21 || sec == 22 || sec == 23 )) {
                     band = "B1";  colorebande = "orange"; iconemarker = L.icon({
    iconUrl: 'b1.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
}); } else { band = "";  iconemarker = L.icon({
    iconUrl: 'default.png',
   iconSize:     [26, 42], // size of the icon
   iconAnchor:   [13, 41], // point of the icon which will correspond to marker's location
   popupAnchor:  [-1, -39] // point from which the popup should open relative to the iconAnchor
});}
                     break;
                
                
                
                
                
      
                
                
                
                
                
                 }} 
			else if (radio == '"umts"')
		 {band = ""; } else if (radio == '"gsm"') {
			 band = ""; }
       if(verificafake == "Si"   && ((APIresponse.lat >= latsinistrabasso && APIresponse.lat <= latdestraalto) && (APIresponse.lon >= lonsinistrabasso && APIresponse.lon <= londestraalto )  )) {
			if(APIresponse.status == "ok" && colorebande != undefined)
	    {
		    arraylat[i] = APIresponse.lat;
		    arraylon[i] = APIresponse.lon;
		    arraycid[i] = cid;
		     arrayenb[i] = enodeb_c;
		    arrayband[i] = band.fontcolor(colorebande);
		     arraysec[i] = sec;
		      uniquearrayband = Array.from(new Set(arrayband))
         i++;
	    } else if(APIresponse.status == "ok" && colorebande == undefined) {
            arraylat[i] = APIresponse.lat;
		    arraylon[i] = APIresponse.lon;
		    arraycid[i] = cid;
		     arrayenb[i] = enodeb_c;
		   
		     arraysec[i] = sec;
		      uniquearrayband = Array.from(new Set(arrayband))
         i++;
        }} else if( verificafake != "Si") {
          if(APIresponse.status == "ok" && colorebande != undefined)
	    {
		    arraylat[i] = APIresponse.lat;
		    arraylon[i] = APIresponse.lon;
		    arraycid[i] = cid;
		     arrayenb[i] = enodeb_c;
		    arrayband[i] = band.fontcolor(colorebande);
		     arraysec[i] = sec;
		      uniquearrayband = Array.from(new Set(arrayband))
         i++;
	    } else if(APIresponse.status == "ok" && colorebande == undefined) {
            arraylat[i] = APIresponse.lat;
		    arraylon[i] = APIresponse.lon;
		    arraycid[i] = cid;
		     arrayenb[i] = enodeb_c;
		   
		     arraysec[i] = sec;
		      uniquearrayband = Array.from(new Set(arrayband))
         i++;
        }
        }
			
			 if (radio == '"lte"' && APIresponse.status == "ok" && carrier == "libero" && mnc == 1 && verificafake == "Si"   && ((APIresponse.lat >= latsinistrabasso && APIresponse.lat <= latdestraalto) && (APIresponse.lon >= lonsinistrabasso && APIresponse.lon <= londestraalto ))) 
       {
                        html = '<div class="card-group">';
                       html = '<div class="card col-2" style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button  class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  '<b>LTE ITALY MAP:</b> <a href="https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+" target="_blank"><button class="pure-material-button-contained">LTE ITALY MAP</button></a>  <br />';
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
				 html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";

                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";
                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec , {permanent: true, direction: 'bottom'}).openTooltip();
                               const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['eNb', ...arrayenb],
        ['Settori', ...arraysec],
        ['Cell ID', ...arraycid]
        
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }           } else if (radio == '"lte"' && APIresponse.status == "ok" && carrier == "libero" && mnc == 1 && verificafake != "Si" ) 
      {
                        html = '<div class="card-group">';
                       html = '<div class="card col-2" style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button  class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  '<b>LTE ITALY MAP:</b> <a href="https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+" target="_blank"><button class="pure-material-button-contained">LTE ITALY MAP</button></a>  <br />';
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
				 html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";

                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";
                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec , {permanent: true, direction: 'bottom'}).openTooltip();
                               const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['eNb', ...arrayenb],
        ['Settori', ...arraysec],
        ['Cell ID', ...arraycid]
        
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }           }
                   else if(radio == '"lte"' && APIresponse.status == "ok"  && carrier != "timers" && carrier != "sctim" && verificafake == "Si"   && ((APIresponse.lat >= latsinistrabasso && APIresponse.lat <= latdestraalto) && (APIresponse.lon >= lonsinistrabasso && APIresponse.lon <= londestraalto ))) 
                   {
                         html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                         html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
			    html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";
			    html += "<b>BAND:</b> " + band.fontcolor(colorebande) + "<br />";
                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";

                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: iconemarker}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br /><b>BAND:</b> " + band.fontcolor(colorebande) + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec + " " + band.fontcolor(colorebande) , {permanent: true, direction: 'bottom'}).openTooltip();
                      
                        
                        
                    } else if(radio == '"lte"' && APIresponse.status == "ok"  && carrier != "timers" && carrier != "sctim" && verificafake != "Si" ) 
                    {
                         html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                         html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
			    html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";
			    html += "<b>BAND:</b> " + band.fontcolor(colorebande) + "<br />";
                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";

                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: iconemarker}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br /><b>BAND:</b> " + band.fontcolor(colorebande) + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec + " " + band.fontcolor(colorebande) , {permanent: true, direction: 'bottom'}).openTooltip();
                      
                        
                        
                    }  else if (radio == '"lte"' && APIresponse.status == "ok" && (carrier == "timers" || carrier == "sctim") && verificafake == "Si"   && ((APIresponse.lat >= latsinistrabasso && APIresponse.lat <= latdestraalto) && (APIresponse.lon >= lonsinistrabasso && APIresponse.lon <= londestraalto )  )) {
                        html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
			    html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";

                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";
                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec , {permanent: true, direction: 'bottom'}).openTooltip();
                                       

  }   else if (radio == '"lte"' && APIresponse.status == "ok" && (carrier == "timers" || carrier == "sctim") && verificafake != "Si") {
                        html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
			    html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";

                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";
                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTOR:</b> " + sec + "<br />").openPopup();
                         marker.bindTooltip(enodeb_c + ":" + sec , {permanent: true, direction: 'bottom'}).openTooltip();
                                       

  }
			 else  if((radio == '"umts"' || radio == '"gsm"') && APIresponse.status == "ok" && verificafake == "Si"   && ((APIresponse.lat >= latsinistrabasso && APIresponse.lat <= latdestraalto) && (APIresponse.lon >= lonsinistrabasso && APIresponse.lon <= londestraalto )  )) {
                         html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                           html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
				 html += "<b>CID:</b> " + cid + "<br />";
                       
                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";

                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br />").openPopup();
                         marker.bindTooltip("<span>" + cid + "</span>", {permanent: true, direction: 'bottom'}).openTooltip();
			
			                    


	
	} else  if((radio == '"umts"' || radio == '"gsm"') && APIresponse.status == "ok" && verificafake != "Si") {
                         html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+APIresponse.lat+","+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                           html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+APIresponse.lat+"/"+APIresponse.lon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
				 html += "<b>CID:</b> " + cid + "<br />";
                       
                        html += "<b>ACCURACY:</b> " + APIresponse.accuracy + "<br />";
                         html += "<b>ADDRESS:</b> " + APIresponse.address + "<br />";
                        html += "<b>LAT:</b> " + APIresponse.lat + "<br />";
                        html += "<b>LON:</b> " + APIresponse.lon + "<br /><br />";
                        html += "</div>";

                        $("#result").append(html);
                        var marker = L.marker([ APIresponse.lat, APIresponse.lon], {icon: defaultmarkericon}).addTo(map);
                        marker.bindPopup("<b>LAT:</b> " + APIresponse.lat + "<br /><b>LON:</b> " + APIresponse.lon + "<br /><b>CID:</b> " + cid + "<br />").openPopup();
                         marker.bindTooltip("<span>" + cid + "</span>", {permanent: true, direction: 'bottom'}).openTooltip();
			
			                    


	
	}
                    //altrimenti, messaggio di errore
                    else {
			    if(APIresponse.message == "Token balance over; you have used up all your requests for today" && NumToken < arrayToken.length - 1) {NumToken++; cid--;}

                         html = '<div class="card col-2"  style="padding-top:10px;">';
                        html += "<b>CID:</b> " + cid + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>SECTOR:</b> " + sec + "<br />";
			html += "<b>MESSAGGIO DI ERRORE:</b> " + APIresponse.message + "<br />";
                        html += "<i>Not found</i> <br /><br />";
                        html += "</div>";

                        $("#result").append(html);
                    }
                });
             }
            var medialon = 0;
            var medialat = 0;

            for(var i =0; i<arraylon.length; i++)
            {
                medialon += arraylon[i];
                medialat += arraylat[i];
            }

            medialon = medialon/arraylon.length;
            medialat = medialat/arraylat.length;
            if(triangolazione == "si" && carrier != "libero" && (startcid != stopcid) && radio == '"lte"' && verificafake == "Si"   && ((medialat >= latsinistrabasso && medialat <= latdestraalto) && (medialon >= lonsinistrabasso && medialon <= londestraalto )  ) ) {
		     html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html += "<b>TRIANGOLAZIONE</b>";
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+medialat+","+medialon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+medialat+"/"+medialon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
                 
		    html += "<b>BANDS:</b> "  + "<span>" + uniquearrayband + "</span>" + "<br />";
		    html += "<b>SECTORS:</b> " + arraysec + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>LAT:</b> " + medialat + "<br />";
                        html += "<b>LON:</b> " + medialon + "<br /><br />";
                    
                        html += "</div>";

$("#result").append(html);
                   var marker = L.marker([medialat, medialon], {icon: srb}).addTo(map);
                marker.bindPopup("<b>LAT:</b> " + medialat + "<br /><b>LON:</b> " + medialon + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTORS:</b> " + arraysec + "<br /><b>BANDS:</b> " + uniquearrayband + "<br />").openPopup();
                marker.bindTooltip( "<span>" + enodeb_c + "</span>", {permanent: true, direction: 'bottom'}).openTooltip();
                            const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      var settoriscansione1 = arraysec.join(";");
      var settoriscansione = settoriscansione1.toString();
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['eNb', ...arrayenb],
        ['Settori', ...arraysec],
        ['Latitudine triangolazione', medialat],
        ['Longitudine triangolazione', medialon], 
        ['Cell ID', ...arraycid],
        ['Settori totali', settoriscansione]
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }     } else if(triangolazione == "si" && carrier != "libero" && (startcid != stopcid) && radio == '"lte"' && verificafake != "Si" ) {
		     html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html += "<b>TRIANGOLAZIONE</b>";
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+medialat+","+medialon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        
                        html +=  "<b>LTE ITALY BASESTATION:</b> <a href='https://lteitaly.it/it/internal/map.php#bts="+mcc+""+mnc+"."+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY BASESTATION</button></a>  <br />";
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+medialat+"/"+medialon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        html +=  "<b>CELLTRACKER:</b> <a href='https://celltracker.it/bts/"+mcc+"/"+mnc+"/"+enodeb_c+"' target='_blank'><button class='pure-material-button-contained'>CELLTRACKER</button></a>  <br />";
                 
		    html += "<b>BANDS:</b> "  + "<span>" + uniquearrayband + "</span>" + "<br />";
		    html += "<b>SECTORS:</b> " + arraysec + "<br />";
                        html += "<b>ENODEB:</b> " + enodeb_c + "<br />";
                        html += "<b>LAT:</b> " + medialat + "<br />";
                        html += "<b>LON:</b> " + medialon + "<br /><br />";
                    
                        html += "</div>";

$("#result").append(html);
                   var marker = L.marker([medialat, medialon], {icon: srb}).addTo(map);
                marker.bindPopup("<b>LAT:</b> " + medialat + "<br /><b>LON:</b> " + medialon + "<br /><b>ENODEB:</b> " + enodeb_c + "<br /><b>SECTORS:</b> " + arraysec + "<br /><b>BANDS:</b> " + uniquearrayband + "<br />").openPopup();
                marker.bindTooltip( "<span>" + enodeb_c + "</span>", {permanent: true, direction: 'bottom'}).openTooltip();
                            const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      var settoriscansione1 = arraysec.join(";");
      var settoriscansione = settoriscansione1.toString();
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['eNb', ...arrayenb],
        ['Settori', ...arraysec],
        ['Latitudine triangolazione', medialat],
        ['Longitudine triangolazione', medialon], 
        ['Cell ID', ...arraycid],
        ['Settori totali', settoriscansione]
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }     } else if(triangolazione == "si" && carrier != "libero"  && (startcid != stopcid) &&  (radio == '"umts"' || radio == '"gsm"') && verificafake == "Si"   && ((medialat >= latsinistrabasso && medialat <= latdestraalto) && (medialon >= lonsinistrabasso && medialon <= londestraalto )  ) ) {
                    html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html += "<b>TRIANGOLAZIONE</b>";
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+medialat+","+medialon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        
                       
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+medialat+"/"+medialon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        
                  
                     
                        html += "<b>LAT:</b> " + medialat + "<br />";
                        html += "<b>LON:</b> " + medialon + "<br /><br />";
                    
                        html += "</div>";

$("#result").append(html);
		     var marker = L.marker([medialat, medialon], {icon: srb}).addTo(map);
                marker.bindPopup("<b>LAT:</b> " + medialat + "<br /><b>LON:</b> " + medialon + "<br />" ).openPopup();
                marker.bindTooltip( "BTS", {permanent: true, direction: 'bottom'}).openTooltip();
 const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['Latitudine triangolazione', medialat],
        ['Longitudine triangolazione', medialon], 
        ['Cell ID', ...arraycid]
        
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }  } else if(triangolazione == "si" && carrier != "libero"  && (startcid != stopcid) &&  (radio == '"umts"' || radio == '"gsm"') && verificafake != "Si") {
                    html = '<div class="card-group">';
                       html = '<div class="card col-2"  style="padding-top:10px;">';
                        html += "<b>TRIANGOLAZIONE</b>";
                        html +=  "<b>MAPS:</b> <a href='http://maps.google.com/?q="+medialat+","+medialon+"' target='_blank'><button class='pure-material-button-contained'>MAPS</button></a>  <br />";
                        
                       
                        html +=  "<b>LTE ITALY MAP:</b> <a href='https://lteitaly.it/it/internal/map.php#16/"+medialat+"/"+medialon+"' target='_blank'><button class='pure-material-button-contained'>LTE ITALY MAP</button></a>  <br />";
                        
                  
                     
                        html += "<b>LAT:</b> " + medialat + "<br />";
                        html += "<b>LON:</b> " + medialon + "<br /><br />";
                    
                        html += "</div>";

$("#result").append(html);
		     var marker = L.marker([medialat, medialon], {icon: srb}).addTo(map);
                marker.bindPopup("<b>LAT:</b> " + medialat + "<br /><b>LON:</b> " + medialon + "<br />" ).openPopup();
                marker.bindTooltip( "BTS", {permanent: true, direction: 'bottom'}).openTooltip();
 const inverseMatrix = 
      (matrix) => {
        let matrixInverted = [[]]

        matrix.forEach(
          (innerArray, indexOut) =>
            innerArray.forEach(
              (valueIn, indexIn) => {
                if(matrixInverted[indexIn] === undefined) matrixInverted[indexIn] = []  
                matrixInverted[indexIn][indexOut] = valueIn
              }
            )
        )

        return matrixInverted
      }
      
      const rows = [
        ['Latitudine', ...arraylat],
        ['Longitudine', ...arraylon],
        ['Latitudine triangolazione', medialat],
        ['Longitudine triangolazione', medialon], 
        ['Cell ID', ...arraycid]
        
      ];
  let csvContent = "data:text/csv;charset=utf-8,";
      inverseMatrix(rows).forEach(function(rowArray) {
        let row = rowArray.join(",");
        csvContent += row + "\r\n";
      });

      var encodedUri = encodeURI(csvContent);
      var link = document.createElement("a");
      link.setAttribute("href", encodedUri);
      link.setAttribute("download", "risultati.csv");
      document.body.appendChild(link);
      var r = confirm("Vuoi scaricare i risultati di questa scansione?");
      if (r == true) {
          link.click()
      }  }
        }else {
            alert("Start CID must be <= than stop CID");
        }
    }

    </script>
</head>
<body>
    <script>
        function showResults() {
              var results = document.getElementById("risultati");
  if (results.style.display === "none") {
    results.style.display = "block";
  }
        }
    </script>
    <div class="form-row" style="margin-top: 10px; margin-bottom: 10px;">
   
        <input type="number"  value="222" class="form-control" id="mcc" placeholder="MCC" required>
        
	    <input type="number" class="form-control" list="MNCs" name="MNC" id="mnc" placeholder="MNC" required>
    <datalist id="MNCs">
        <option value="10">VODAFONE</option>
        <option value="1">TIM</option>
        <option value="99">H3G</option>
        <option value="50">ILIAD</option>
        <option value="88">WINDTRE</option>
    </datalist>
        <input type="number" class="form-control" id="startcid" placeholder="Start CID" required>
        <input type="number" class="form-control" id="stopcid" placeholder="Stop CID" required>
        <input type="number" class="form-control" id="enodeb" placeholder="Enodeb" required>
	<input type="number" value="1" class="form-control" id="lac" placeholder="Lac" required>
	<input type="number" class="form-control" id="secid" placeholder="Sector" required>
        <input type="text" class="form-control" id="token" placeholder="Token" required>
	<input type="number" value="0" class="form-control" id="psc" placeholder="Psc" required>
	     <input type="number" class="form-control" id="cidumts" placeholder="CidUmts" required  >
    <input type="number" class="form-control" id="rnc" placeholder="RNC" required>
    <input type="text" class="form-control" id="coordinatedestra" placeholder="LatLng Destra" required>
    <input type="text" class="form-control" id="coordinatesinistra" placeholder="LatLng Sinistra" required>
	
        <select id="radio" class="form-control" onchange="miafunzione(this)">
             <option selected disabled>RADIO</option>
	    <option value='"lte"'>LTE</option>
            <option value='"umts"'>UMTS</option>
            <option value='"gsm"'>GSM</option>
            
          </select>
        
        <select id="carrier" class="form-control" onchange="miaf2(this)">
             <option selected disabled>CARRIER</option>
		<option value= "vf" >VODAFONE</option>
            <option value= "timHUAWEI" >TIM HUAWEI</option>
            <option value= "timHUAWEIB1" >TIM HUAWEI B1 SICILIA</option>
            <option value= "tim" >TIM NOKIA E E///</option>
	     <option value= "timers" >TIM ERICSSON</option>
		<option value= "sctim" >SC TIM</option>
            <option value= "h3g" >H3G ITALIA</option>
            <option value= "iliad" >ILIAD</option>
            <option value= "w3" >WINDTRE</option>
	    <option value= "libero" >LIBERO</option>
            
          </select>
	
	  <select id="triangolazione" class="form-control" >
          <option selected disabled>TRIANGULATION</option>
		  <option value="si">SI</option>
            <option value="no">NO</option>
            
          </select>
          <select id="verificafake" class="form-control" >
            <option selected disabled>VERIFICA FAKE</option>
        <option value="Si">SI</option>
              <option value="No">NO</option>
              
            </select>
	    
        <button class="pure-material-button-contained" onclick="AllScan();showResults();">Go</button>
        </div>
	<div id="accordion">
  <div class="card" id="risultati" style="display: none; margin-bottom: 10px;">
    <div class="card-header" id="headingOne" style="max-height: 50px; background-color: rgba(0,0,0,.00);">
      <h5 class="mb-0"  style="max-height: 30px !important">
        <button style="color: #333; padding: 0px !important; margin: 0px !Important" class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
          Risultati scansione
        </button>
      </h5>
    </div>
	  
    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
      <div class="card-body">

         <div class="container-fluid pt-2 pb-2">  
        <div id="result" class="row pt-2"></div>
    </div>
	      </div>
    </div>
  </div>
 
    <div id="map"></div>
    
    <script>
 document.getElementById("enodeb").disabled = false;
    document.getElementById("secid").disabled = true;
    document.getElementById("cidumts").disabled = true;
    document.getElementById("rnc").disabled = true;
	  document.getElementById("psc").disabled = true;   
	      document.getElementById("carrier").disabled = false;
	    document.getElementById("triangolazione").disabled = false;
   function miafunzione(selectObject) {
  switch(selectObject.value) {
   case '"lte"': 
   document.getElementById("enodeb").disabled = false;
   document.getElementById("secid").disabled = true;
    document.getElementById("cidumts").disabled = true;
    document.getElementById("rnc").disabled = true;
		  document.getElementById("carrier").disabled = false;
  
  break;
 case '"umts"': 
    document.getElementById("enodeb").disabled = true;
    document.getElementById("secid").disabled = true;
    document.getElementById("cidumts").disabled = false;
    document.getElementById("rnc").disabled = false;
		   document.getElementById("carrier").disabled = true;
    document.getElementById("psc").disabled = false;
 
 break;
case '"gsm"':
    document.getElementById("enodeb").disabled = true;
    document.getElementById("secid").disabled = true;
    document.getElementById("cidumts").disabled = true;
    document.getElementById("rnc").disabled = true;
		   document.getElementById("carrier").disabled = true;
    document.getElementById("psc").disabled = false;

    break; 
  }}


function miaf2(selectObject) {
  switch(selectObject.value) {
   case "libero": 
 
    document.getElementById("secid").disabled = false;
    document.getElementById("psc").disabled = false;
		  document.getElementById("triangolazione").disabled = true;
 

    break; 
    case "vf":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case "timHUAWEI":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break ;
    case "timHUAWEIB1":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case "tim":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case "timers":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case "h3g":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case "iliad":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    case  "w3":
    document.getElementById("secid").disabled = true;
    document.getElementById("psc").disabled = true;
		   document.getElementById("triangolazione").disabled = false;
    break;
    
 
 
 
 
  }}
let btn = document.createElement('button');
btn.innerText = 'Delete Marker';
btn.onclick =  function() {
  map.removeLayer(results);
}


                    // API token goes here
var key = "9f2c971b2cd69c";

// Add layers that we need to the map
var streets = L.tileLayer.Unwired({key: key, scheme: "streets"});
	    var osm = L.tileLayer(
  'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Data © <a href="http://osm.org/copyright">OpenStreetMap</a>',
    maxZoom: 18
  });
	    var satellite = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
});


// Initialize the map

var map = L.map('map', {
        center: [ 42.6197784,11.5083833 ], //map loads with this location as center
        zoom: 6,
        layers: [osm] // Show 'osm' by default
});
// Add the 'layers' control
L.control.layers({
        "Streets": streets,
        "OSM": osm,
	"SAT": satellite,
    }, null, {
        position: "topright"
    }).addTo(map);

    map.on("dblclick", function(e){
        var mp = new L.Marker([e.latlng.lat, e.latlng.lng]).addTo(map);
        mp.bindPopup(e.latlng.lat + ',' + e.latlng.lng);
 }); 
 var gpslayer = new L.LayerGroup().addTo(map);
 // Add the 'scale' control
    L.control.scale().addTo(map);
    L.control.locate({
        position: "bottomright",
	     layer: gpslayer,
	     locateOptions: {
               enableHighAccuracy: true
}
    }).addTo(map);


//Add the 'search' control
	    
	    var searchicon = L.icon({
    iconUrl: 'me.png',
    

    iconSize:     [38, 38], // size of the icon
    
  
});

var searchControl = new L.esri.Controls.Geosearch().addTo(map);

            var results = new L.LayerGroup().addTo(map);

              searchControl.on('results', function(data){
                results.clearLayers();
                for (var i = data.results.length - 1; i >= 0; i--) {
                  results.addLayer(L.marker(data.results[i].latlng ,  {icon: searchicon}).bindPopup(btn, {
  maxWidth: 'auto'
})),map.addLayer(results);
                }
              });

        
         const maps = [streets]; 
        const resetcontrol = L.Control.extend({

    options: {
        position: 'topright'
    },
    onAdd: function () {
        const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom');
        container.style.cursor= 'pointer';
        container.innerHTML = '<a class="darkmodetoggle"><i class="material-icons">delete</i></a>';

        container.onclick = function () {
          map.eachLayer(function (layer) {
            if(!maps.includes(layer) && layer != osm && layer != satellite && layer != editableLayers && layer != results && layer != gpslayer )
              map.removeLayer(layer);
          });
        };
        return container;
    },

});
map.addControl(new resetcontrol);
	    var gpsbest = new L.Control.Permalink({ useLocation: true, text: null })
	        map.addControl(gpsbest);
	    var editableLayers = new L.FeatureGroup();
    map.addLayer(editableLayers);
    
    
    
    var options = {
        position: 'topright',
        draw: {
            polyline: {
                shapeOptions: {
                    color: '#f357a1',
                    weight: 10
                }
            },
            polygon: {
                allowIntersection: false, // Restricts shapes to simple polygons
                drawError: {
                    color: '#e1e100', // Color the shape will turn when intersects
                    message: '<strong>Oh snap!<strong> you can\'t draw that!' // Message that will show when intersect
                },
                shapeOptions: {
                    color: '#bada55'
                }
            },
            circle: false, // Turns off this drawing tool
            rectangle: {
                shapeOptions: {
                    clickable: false
                }
            },
            marker: false
        },
        edit: {
            featureGroup: editableLayers, //REQUIRED!!
            remove: true
        }
    };
    
    var drawControl = new L.Control.Draw(options);
    map.addControl(drawControl);
    
    map.on(L.Draw.Event.CREATED, function (e) {
        var type = e.layerType,
            layer = e.layer;
    
      
    
        editableLayers.addLayer(layer);
    });
        </script>
</body>
</html>
